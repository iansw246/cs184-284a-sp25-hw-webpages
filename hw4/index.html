<html>
	<head>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default'></script>
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
		<style>
			h1 {
				text-align: center;
			}

			.container {
				margin: 0 auto;
				padding: 60px 20%;
			}

			figure {
				text-align: center;
			}

			img {
				display: inline-block;
			}

			body {
				font-family: 'Inter', sans-serif;
			}
		</style>
	</head>
	<body>
		<div class="container">
		<h1>CS184/284A Spring 2025 Homework 4 Write-Up</h1>
		<div style="text-align: center;">Names: </div>

		<br>

		Link to webpage: (TODO) <a href="https://cs184.eecs.berkeley.edu/sp25">cs184.eecs.berkeley.edu/sp25</a>

		<br>

		Link to GitHub repository: (TODO) <a href="https://cs184.eecs.berkeley.edu/sp25">cs184.eecs.berkeley.edu/sp25</a>

		<figure>
			<img src="clothsim.png" alt="Cloth draped over sphere" style="width:70%"/>
			<figcaption>You can add images with captions!</figcaption>
		</figure>

		<!--
		We've already added one heading per part, to make your write-up as navigable when grading. Please fit your write-up within these sections!
		-->

		<h2>Overview</h2>
		Give a high-level overview of what you implemented in this homework. Think about what you've built as a whole. Share your thoughts on what interesting things you've learned from completing the homework.

		<h2>Part 1: Masses and springs</h2>
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

		<p>Here is an example 2x2 gridlike structure using an HTML table. Each <b>tr</b> is a row and each <b>td</b> is a column in that row. You might find this useful for framing and showing your result images in an organized fashion.</p>
		<div style="display: flex; flex-direction: column; align-items: center;">
			<table style="width: 100%; text-align: center; border-collapse: collapse;">
			  <tr>
				<td style="text-align: center;">
				  <img src="clothsim.png" width="400px"/>
				  <figcaption>Caption goes here.</figcaption>
				</td>
				<td style="text-align: center;">
				  <img src="clothsim.png" width="400px"/>
				  <figcaption>Caption goes here.</figcaption>
				</td>
			  </tr>
			  <tr>
				<td style="text-align: center;">
				  <img src="clothsim.png" width="400px"/>
				  <figcaption>Caption goes here.</figcaption>
				</td>
				<td style="text-align: center;">
				  <img src="clothsim.png" width="400px"/>
				  <figcaption>Caption goes here.</figcaption>
				</td>
			  </tr>
			</table>
		</div>

		<h2>Part 2: Simulation via numerical integration</h2>
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

		<h2>Part 3: Handling collisions with other objects</h2>
		<h3>Implementation</h3>
		The cloth can intersect with spheres and planes.
		<h4>Spheres</h4>
		<p>
			For sphere intersection, each the distance from
			each point mass to each sphere's center is checked.
			If the distance less than the sphere's radius, the point mass has
			collided with the sphere.
			In this case, we calculate the tangent point on the sphere's
			surface that the point mass would have collided with if it did
			not go through the sphere. Finally, we adjust the point mass's
			position toward the tangent point scaled by friction.
		</p>
		<h4>Planes</h4>
		<p>
			Plane intersection is checked by checking for line-plane intersection
			along the line segment from the old to the new position.
			This is accomplished by solving the following equation for \(d \):
			\[
				(p - p_0) \cdot n = p_0 + (p_1 - p_0) d
			\]
			where \( p \) is a point in the plane, \( n \) is the plane's normal vector,
			and \( p_0, p_1 \) is the point mass's old and new position, respectively.
		</p>
		<p>
			If \( 0 \lt d \lt 1 \), then a collision has occurred.
			The point on the plane that the point mass would have collided with
			if it did not go through the plane is called the tangent point
			and is equal to \(p_0 + d (p_1 - p_0) \).
			To offset slightly above the plane,
			\( d - \delta \) is used instead of \( d \) for the above equation
			where \( \delta \) is a small constant.
			The vector from the old position to the new point above the plane
			is called the correction vector.
		</p>
		<p>
			Finally, the point mass's position is adjusted by correction vector
			scaled by \( 1 - f \) where \( f \) is the friction.
		</p>

		TODO Shaded cloth different ks

		<figure>
			<img src="images/plane.png">
			<figcaption>The cloth lying at rest on the plane</figcaption>
		</figure>


		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

		<h2>Part 4: Handling self-collisions</h2>
		<h3>Implementation</h3>
		<p>
			To handle self-collisions efficiently, each point mass of the cloth
			is assigned to a box based on its position.
			When checking collisions, only points in the same and adjacent boxes
			must be checked.
		</p>
		<p>
			The 3D space is partitioned into 3D boxes. For a cloth with dimensions
			\( w \times h \) and \( n_w \times n_h \) points spanning the width and height,
			the box dimensions are
			\( \frac{3w}{n_w} \times \frac{3h}{n_h} \times \max(\frac{3w}{n_w}, \frac{3h}{n_h}) \).
			Each coordinate of a point mass's position is floor divided by the size of a box
			in the corresponding coordinate to get the integer coordinate of the
			box.
		</p>
		<p>
			In each simulation step, the hash table is first built.
			Then for each point, the distance from all other points in the same box
			are checked. If the distance is less than
			\(2 \ast thickness \), they are considered to have collided.
			The vector needed to move the initial point to a
			distance \(2 \ast thickness \) from the other, called the correction vector,
			is calculated. The average of all correction vectors over all
			colliding points, scaled down by the number of simulation steps,
			is the final adjustment to the point's position.
		</p>
		<p>
			The following screenshots show the progression of a
			cloth folding on itself.

			<figure>
				<img src="images/self-collide-1.png">
				<img src="images/self-collide-2.png">
				<img src="images/self-collide-3.png">
			</figure>
		</p>

		<h2>Part 5: Shaders</h2>
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

		<h2>(Optional) Part 6: Extra Credit - Additional cloth simulation features!</h2>
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		
		<h2>Additional Notes (please remove)</h2>
		<ul>
			<li>You can also add code if you'd like as so: <code>code code code</code></li>
			<li>If you'd like to add math equations, 
				<ul>
					<li>You can write inline equations like so: \( a^2 + b^2 = c^2 \)</li>
					<li>You can write display equations like so: \[ a^2 + b^2 = c^2 \]</li>
				</ul>
			</li>
		</ul>
		</div>
	</body>
</html>